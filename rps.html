<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RPS Battle Arena</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r134/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vanta/dist/vanta.waves.min.js"></script>
  <style>
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: sans-serif;
  overflow: hidden;
  user-select: none;
  touch-action: none;
  background: #111;
}

/* VANTA BACKGROUND */
#vanta-bg {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 0;
}

/* GAME CANVAS */
#gameCanvas {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 1;
  background: transparent;
}

/* START SCREEN */
#startScreen {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  color: white;
  z-index: 150;
  background: #111;
}

#startScreen h1 {
  font-size: 48px;
  margin-bottom: 20px;
  animation: fadeIn 2s infinite alternate, titleGlow 1.5s infinite alternate;
  text-shadow: 0 0 5px #0ff, 0 0 10px #0ff, 0 0 20px #0ff;
}

/* BUTTONS */
#startBtn, #restartBtn {
  background: linear-gradient(45deg, #0af, #0fc, #0af);
  border: none;
  border-radius: 15px;
  padding: 12px 25px;
  color: white;
  font-size: 16px;
  font-weight: bold;
  cursor: pointer;
  width: 100%;
  margin-top: 10px;
  text-transform: uppercase;
  box-shadow: 0 0 15px rgba(0,255,255,0.7), 0 5px 20px rgba(0,0,0,0.4);
  transition: all 0.3s ease;
}

#startBtn:hover, #restartBtn:hover {
  animation: glowPulse 1s infinite alternate;
  transform: scale(1.05) rotate(-1deg);
  box-shadow: 0 0 35px rgba(0,255,255,1), 0 8px 25px rgba(0,0,0,0.5);
}

#startBtn:active, #restartBtn:active {
  transform: scale(0.97);
  box-shadow: 0 0 15px rgba(0,255,255,0.8), 0 4px 15px rgba(0,0,0,0.4);
}

@keyframes glowPulse {
  0% { box-shadow: 0 0 15px rgba(0,255,255,0.7), 0 5px 20px rgba(0,0,0,0.4); }
  100% { box-shadow: 0 0 35px rgba(0,255,255,1), 0 10px 25px rgba(0,0,0,0.5); }
}

/* MENU */
#menu {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: rgba(0,0,0,0.8);
  color: white;
  padding: 25px;
  border-radius: 15px;
  backdrop-filter: blur(5px);
  z-index: 100;
  opacity: 0;
  transition: opacity 0.6s;
}

#menu.show {
  opacity: 1;
}

/* INPUTS */
.input-row {
  display: flex;
  align-items: center;
  margin: 8px 0;
  gap: 10px;
}

.emoji {
  font-size: 20px;
  width: 30px;
}

input {
  background: rgba(255,255,255,0.2);
  border: 1px solid rgba(255,255,255,0.3);
  border-radius: 5px;
  padding: 5px 8px;
  color: white;
  width: 60px;
  text-align: center;
}

input:focus {
  outline: none;
  border-color: #0ff;
  box-shadow: 0 0 10px #0ff;
}

/* STATS */
#stats {
  position: absolute;
  bottom: 10px;
  left: 10px;
  background: rgba(0,0,0,0.8);
  color: white;
  padding: 10px;
  border-radius: 10px;
  display: none;
  font-size: 14px;
  backdrop-filter: blur(5px);
  z-index: 120;
  text-shadow: 0 0 5px #0ff, 0 0 10px #0ff;
}

.stat {
  margin: 3px 0;
}

/* WINNER */
#winner {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: rgba(255,215,0,0.9);
  color: #333;
  padding: 30px;
  border-radius: 15px;
  text-align: center;
  display: none;
  font-size: 20px;
  font-weight: bold;
  opacity: 0;
  transition: opacity 0.5s;
  z-index: 200;
  text-shadow: 0 0 10px #ff0, 0 0 20px #ff0, 0 0 30px #ffa500;
}

/* ELIMINATION */
#elimination {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: rgba(255,0,0,0.8);
  color: white;
  padding: 25px 40px;
  border-radius: 15px;
  font-size: 24px;
  font-weight: bold;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.7s;
  z-index: 250;
  text-shadow: 0 0 10px #f00, 0 0 20px #f00, 0 0 30px #ff4500;
}

/* ANIMATIONS */
@keyframes fadeIn {
  from { opacity: 0.2; }
  to { opacity: 1; }
}

@keyframes titleGlow {
  0% { text-shadow: 0 0 5px #0ff, 0 0 10px #0ff, 0 0 20px #0ff; }
  100% { text-shadow: 0 0 15px #0ff, 0 0 30px #0ff, 0 0 40px #0ff; }
}

</style>
</head>
<body>

<div id="vanta-bg"></div>

<div id="startScreen">
  <h1>ü™®‚úÇÔ∏èüìÑ RPS Battle Arena</h1>
  <button id="enterBtn" style="padding:10px 25px;font-size:18px;cursor:pointer;border-radius:10px;border:none;background:#0a5;color:white;">Enter Arena</button>
</div>

<div id="menu">
  <div class="input-row"><span class="emoji">ü™®</span><label>Rock:</label><input type="number" id="rock" value="12" min="1" max="10000"></div>
  <div class="input-row"><span class="emoji">üìÑ</span><label>Paper:</label><input type="number" id="paper" value="12" min="1" max="10000"></div>
  <div class="input-row"><span class="emoji">‚úÇÔ∏è</span><label>Scissors:</label><input type="number" id="scissors" value="12" min="1" max="10000"></div>
  <button id="startBtn">Start Battle</button>
</div>

<div id="stats">
  <div class="stat">ü™® <span id="rockCount">0</span></div>
  <div class="stat">üìÑ <span id="paperCount">0</span></div>
  <div class="stat">‚úÇÔ∏è <span id="scissorsCount">0</span></div>
</div>

<div id="winner"><div id="winnerText"></div><button id="restartBtn">Play Again</button></div>
<div id="elimination">ROCK IS ELIMINATED!</div>

<canvas id="gameCanvas"></canvas>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");
function resizeCanvas(){ canvas.width=window.innerWidth; canvas.height=window.innerHeight; }
resizeCanvas();
window.addEventListener('resize',resizeCanvas);

const menu=document.getElementById("menu");
const stats=document.getElementById("stats");
const winner=document.getElementById("winner");
const elimination=document.getElementById("elimination");
const startScreen=document.getElementById("startScreen");
const enterBtn=document.getElementById("enterBtn");

const emojiMap={ rock:"ü™®", paper:"üìÑ", scissors:"‚úÇÔ∏è" };

let eliminatedTypes = new Set();

class Particle {
  constructor(x, y, color) {
    this.x = x;
    this.y = y;
    this.vx = (Math.random() - 0.5) * 6;
    this.vy = (Math.random() - 0.5) * 6;
    this.alpha = 1;          // fully visible at start
    this.size = Math.random() * 4 + 2;
    this.color = color;
  }

  update() {
    this.x += this.vx;
    this.y += this.vy;
    this.size *= 0.92;       // gradually shrink
    this.alpha *= 0.92;      // gradually fade
  }

  draw() {
    if (this.alpha <= 0.01 || this.size <= 0.5) return; // stop drawing tiny invisible particles
    ctx.globalAlpha = this.alpha;
    ctx.fillStyle = this.color;
    ctx.beginPath();
    ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
    ctx.fill();
    ctx.globalAlpha = 1;
  }
}

class Entity{
  constructor(type){ this.type=type; this.size=35; this.x=Math.random()*(canvas.width-100)+50; this.y=Math.random()*(canvas.height-100)+50;
    const speed=Math.random()*3+2; const angle=Math.random()*Math.PI*2; this.vx=Math.cos(angle)*speed; this.vy=Math.sin(angle)*speed; }
  draw(){ ctx.font=`${this.size}px sans-serif`; ctx.textAlign='center'; ctx.textBaseline='middle'; ctx.fillText(emojiMap[this.type],this.x,this.y); }
  update(){ this.x+=this.vx; this.y+=this.vy; if(this.x<20||this.x>canvas.width-20)this.vx*=-0.9; if(this.y<20||this.y>canvas.height-20)this.vy*=-0.9;
    this.x=Math.max(20,Math.min(canvas.width-20,this.x)); this.y=Math.max(20,Math.min(canvas.height-20,this.y)); }
}

let entities=[], particles=[], gameRunning=false, shakeOffset={x:0,y:0};

function startGame(){
  document.getElementById('vanta-bg').style.display = 'block';
  entities=[]; particles=[]; gameRunning=true; shakeOffset={x:0,y:0}; eliminatedTypes.clear();
  const rockCount=parseInt(document.getElementById("rock").value);
  const paperCount=parseInt(document.getElementById("paper").value);
  const scissorsCount=parseInt(document.getElementById("scissors").value);
  for(let i=0;i<rockCount;i++) entities.push(new Entity('rock'));
  for(let i=0;i<paperCount;i++) entities.push(new Entity('paper'));
  for(let i=0;i<scissorsCount;i++) entities.push(new Entity('scissors'));

  startScreen.style.display='none';
  menu.classList.remove('show'); setTimeout(()=>menu.style.display='none',600);
  stats.style.display='block'; winner.style.display='none';
  animate();
}

function checkCollision(a,b){ const dx=a.x-b.x; const dy=a.y-b.y; return Math.sqrt(dx*dx+dy*dy)<40; }

function fight(a,b){
  if(a.type===b.type) return;
  if((a.type==='rock' && b.type==='scissors')||(a.type==='scissors' && b.type==='paper')||(a.type==='paper' && b.type==='rock')) b.type=a.type; else a.type=b.type;
  for(let i=0;i<10;i++) particles.push(new Particle((a.x+b.x)/2,(a.y+b.y)/2,'red'));
  shakeOffset.x=(Math.random()-0.5)*10; shakeOffset.y=(Math.random()-0.5)*10;
  checkElimination();
}

function checkElimination(){
  const types=['rock','paper','scissors'];
  types.forEach(t=>{
    if(!entities.some(e=>e.type===t) && !eliminatedTypes.has(t)){
      eliminatedTypes.add(t);
      showElimination(t.toUpperCase());
    }
  });
}

function showElimination(type){
  elimination.textContent=`${type} IS ELIMINATED!`;
  elimination.style.opacity=1;
  setTimeout(()=>{elimination.style.opacity=0},800);
}

function updateStats(){
  const counts={rock:0,paper:0,scissors:0}; entities.forEach(e=>counts[e.type]++);
  document.getElementById('rockCount').textContent=counts.rock;
  document.getElementById('paperCount').textContent=counts.paper;
  document.getElementById('scissorsCount').textContent=counts.scissors;
}

function animate(){
  if(!gameRunning) return;
  ctx.setTransform(1,0,0,1,shakeOffset.x,shakeOffset.y); shakeOffset.x*=0.9; shakeOffset.y*=0.9;
  ctx.clearRect(0,0,canvas.width,canvas.height);


  entities.forEach((e,i) => {
    e.update();
    for(let j = i + 1; j < entities.length; j++){
      if(checkCollision(e, entities[j])) fight(e, entities[j]);
    }
    e.draw();
  });

  for(let i = particles.length - 1; i >= 0; i--){
    const p = particles[i];
    p.update();
    p.draw();
    if(p.alpha <= 0) particles.splice(i, 1);
  }

  updateStats();
  ;

  const types=new Set(entities.map(e=>e.type));
  if(types.size<=1){ gameRunning=false; showWinner([...types][0]||'draw'); return; }
  requestAnimationFrame(animate);
}

function showWinner(type){
  winner.style.display='block';
  setTimeout(()=>winner.style.opacity=1,50);
  document.getElementById('winnerText').innerHTML=type==='draw'?'Draw!':`${emojiMap[type]} ${type.toUpperCase()} WINS!`;
}


function restart(){
  document.getElementById('vanta-bg').style.display = 'block';
  gameRunning=false; winner.style.opacity=0; setTimeout(()=>winner.style.display='none',500);
  stats.style.display='none'; menu.style.display='block'; menu.classList.add('show');
}

document.getElementById('startBtn').addEventListener('click', startGame);
document.getElementById('restartBtn').addEventListener('click', restart);
enterBtn.addEventListener('click',()=>{ startScreen.style.display='none'; menu.classList.add('show'); });

document.addEventListener('touchstart', e=>e.preventDefault());
document.addEventListener('touchmove', e=>e.preventDefault());


let vantaEffect;
function initVanta(){
  if(!vantaEffect){
    vantaEffect = VANTA.WAVES({
      el: "#vanta-bg",
      mouseControls: true,
      touchControls: true,
      gyroControls: false,
      minHeight: 200,
      minWidth: 200,
      scale: 1,
      scaleMobile: 1,
      color: 0x445d6e,
      shininess: 50,
      waveHeight: 20,
      waveSpeed: 1,
    });
  }
}
initVanta();

document.getElementById('vanta-bg').style.display = 'block';


</script>
</body>
</html>
